{"version":3,"file":"NavigationPlugin.js","sourceRoot":"","sources":["../../../src/lib/output/plugins/NavigationPlugin.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,2BAA2C,eAAe,CAAC,CAAA;AAE3D,uBAAuC,WAAW,CAAC,CAAA;AAYnD;IAAsC,oCAAiB;IAAvD;QAAsC,8BAAiB;IA4EvD,CAAC;IAjEG,qCAAU,GAAV;QACI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAE;YACtB,GAAC,sBAAa,CAAC,KAAK,CAAC,GAAE,IAAI,CAAC,eAAe;YAC3C,GAAC,kBAAS,CAAC,KAAK,CAAC,GAAM,IAAI,CAAC,WAAW;;SAC1C,CAAC,CAAC;;IACP,CAAC;IAQO,0CAAe,GAAvB,UAAwB,KAAmB;QACvC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,aAAa,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;IACpE,CAAC;IAQO,sCAAW,GAAnB,UAAoB,IAAc;QAC9B,IAAI,YAAY,GAAoB,EAAE,CAAC;QACvC,CAAC,oBAAoB,IAAmB;YACpC,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;YACvB,IAAI,CAAC,QAAQ,GAAI,KAAK,CAAC;YACvB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;YAEhC,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBAC7F,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC5B,CAAC;YAED,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;gBAChB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAC,KAAK,IAAK,OAAA,UAAU,CAAC,KAAK,CAAC,EAAjB,CAAiB,CAAC,CAAC;YACxD,CAAC;QACL,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAEpB,YAAY,CAAC,OAAO,CAAC,UAAC,IAAmB;YACrC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YAEtB,IAAI,KAAK,GAAG,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;YACpC,IAAI,KAAK,GAAG,CAAC,CAAC;YACd,OAAO,IAAI,EAAE,CAAC;gBACV,IAAI,CAAC,QAAQ,GAAI,IAAI,CAAC;gBACtB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;gBAEtB,KAAK,IAAI,CAAC,CAAC;gBACX,KAAK,IAAI,CAAC,CAAC;gBACX,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA,CAAC;oBACf,KAAK,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;oBAC9B,EAAE,CAAC,CAAC,KAAK,GAAG,CAAC,IAAI,KAAK,GAAG,EAAE,CAAC,CAAC,CAAC;wBAC1B,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAC,KAAK;4BACxB,KAAK,CAAC,SAAS,GAAG,IAAI,CAAA;wBAC1B,CAAC,CAAC,CAAC;oBACP,CAAC;gBACL,CAAC;gBAED,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC;YACvB,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;IACtC,CAAC;IA5EL;QAAC,sBAAS,CAAC,EAAC,IAAI,EAAC,YAAY,EAAC,CAAC;wBAAA;IA6E/B,uBAAC;AAAD,CAAC,AA5ED,CAAsC,8BAAiB,GA4EtD;AA5EY,wBAAgB,mBA4E5B,CAAA","sourcesContent":["import {Component, RendererComponent} from \"../components\";\nimport {NavigationItem} from \"../models/NavigationItem\";\nimport {RendererEvent, PageEvent} from \"../events\";\n\n\n/**\n * A plugin that exposes the navigation structure of the documentation\n * to the rendered templates.\n *\n * The navigation structure is generated using the current themes\n * [[BaseTheme.getNavigation]] function. This plugins takes care that the navigation\n * is updated and passed to the render context.\n */\n@Component({name:\"navigation\"})\nexport class NavigationPlugin extends RendererComponent\n{\n    /**\n     * The navigation structure generated by the current theme.\n     */\n    navigation:NavigationItem;\n\n\n    /**\n     * Create a new NavigationPlugin instance.\n     */\n    initialize() {\n        this.listenTo(this.owner, {\n            [RendererEvent.BEGIN]: this.onBeginRenderer,\n            [PageEvent.BEGIN]:     this.onBeginPage\n        });\n    }\n\n\n    /**\n     * Triggered before the renderer starts rendering a project.\n     *\n     * @param event  An event object describing the current render operation.\n     */\n    private onBeginRenderer(event:RendererEvent) {\n        this.navigation = this.owner.theme.getNavigation(event.project);\n    }\n\n\n    /**\n     * Triggered before a document will be rendered.\n     *\n     * @param page  An event object describing the current render operation.\n     */\n    private onBeginPage(page:PageEvent) {\n        var currentItems:NavigationItem[] = [];\n        (function updateItem(item:NavigationItem) {\n            item.isCurrent = false;\n            item.isInPath  = false;\n            item.isVisible = item.isGlobals;\n\n            if (item.url == page.url || (item.dedicatedUrls && item.dedicatedUrls.indexOf(page.url) != -1)) {\n                currentItems.push(item);\n            }\n\n            if (item.children) {\n                item.children.forEach((child) => updateItem(child));\n            }\n        })(this.navigation);\n\n        currentItems.forEach((item:NavigationItem) => {\n            item.isCurrent = true;\n\n            var depth = item.isGlobals ? -1 : 0;\n            var count = 1;\n            while (item) {\n                item.isInPath  = true;\n                item.isVisible = true;\n\n                count += 1;\n                depth += 1;\n                if (item.children){\n                    count += item.children.length;\n                    if (depth < 2 || count < 30) {\n                        item.children.forEach((child) => {\n                            child.isVisible = true\n                        });\n                    }\n                }\n\n                item = item.parent;\n            }\n        });\n\n        page.navigation = this.navigation;\n    }\n}\n"]}