{"version":3,"file":"helpers.js","sourceRoot":"","sources":["../../../../src/lib/output/utils/resources/helpers.ts"],"names":[],"mappings":"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","sourcesContent":["import * as Path from \"path\";\nimport * as Handlebars from \"handlebars\";\n\nimport {ResourceStack, Resource} from \"./stack\";\n\n\nexport class Helper extends Resource\n{\n    private helpers:any;\n\n\n    getHelpers():any {\n        if (!this.helpers) {\n            var file = require(this.fileName);\n\n            if (typeof file === 'object') {\n                this.helpers = file;\n            } else if (typeof file === 'function') {\n                this.helpers = file();\n            } else {\n                throw new Error('Invalid helper.');\n            }\n        }\n\n        return this.helpers;\n    }\n}\n\n\nexport class HelperStack extends ResourceStack<Helper>\n{\n    private registeredNames:string[] = [];\n\n\n    constructor() {\n        super(Helper, /\\.js$/);\n        this.addCoreHelpers();\n    }\n\n\n    activate():boolean {\n        if (!super.activate()) return false;\n        var resources = this.getAllResources();\n\n        for (var resourceName in resources) {\n            var helpers = resources[resourceName].getHelpers();\n\n            for (var name in helpers) {\n                if (this.registeredNames.indexOf(name) !== -1) continue;\n                this.registeredNames.push(name);\n\n                Handlebars.registerHelper(name, helpers[name]);\n            }\n        }\n\n        return true;\n    }\n\n\n    deactivate():boolean {\n        if (!super.activate()) return false;\n\n        for (var name of this.registeredNames) {\n            Handlebars.unregisterHelper(name);\n        }\n\n        this.registeredNames = [];\n        return true;\n    }\n\n\n    addCoreHelpers() {\n        this.addOrigin('core', Path.join(__dirname, '..', '..', 'helpers'));\n    }\n\n\n    removeAllOrigins() {\n        super.removeAllOrigins();\n        this.addCoreHelpers();\n    }\n}\n"]}