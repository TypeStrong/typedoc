{"version":3,"file":"component.js","sourceRoot":"","sources":["../../../../src/lib/utils/options/sources/component.ts"],"names":[],"mappings":"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","sourcesContent":["import {Component, ComponentEvent, AbstractComponent, ChildableComponent} from \"../../component\";\nimport {OptionsComponent} from \"../options\";\n\n\n@Component({name:\"options:component\"})\nexport class ComponentSource extends OptionsComponent\n{\n    private knownComponents:string[];\n\n\n    protected initialize() {\n        this.knownComponents = [];\n        this.addComponent(this.application);\n\n        this.listenTo(this.application, {\n            [ComponentEvent.ADDED]:   this.onComponentAdded,\n            [ComponentEvent.REMOVED]: this.onComponentRemoved,\n        });\n    }\n\n\n    private addComponent(component:AbstractComponent<any>) {\n        var name = component.componentName;\n        if (!name) {\n            this.application.logger.error(\"Component without name found.\");\n            return;\n        }\n\n        if (this.knownComponents.indexOf(name) === -1) {\n            this.knownComponents.push(name);\n            this.owner.addDeclarations(component.getOptionDeclarations());\n        }\n\n        if (component instanceof ChildableComponent) {\n            for (var child of component.getComponents()) {\n                this.addComponent(child);\n            }\n        }\n    }\n\n\n    private removeComponent(component:AbstractComponent<any>) {\n        var name = component.componentName;\n        var index = this.knownComponents.indexOf(name);\n        if (index != -1) {\n            this.knownComponents.slice(index, 1);\n            for (var declaration of component.getOptionDeclarations()) {\n                this.owner.removeDeclarationByName(declaration.name);\n            }\n        }\n\n        if (component instanceof ChildableComponent) {\n            for (var child of component.getComponents()) {\n                this.removeComponent(child);\n            }\n        }\n    }\n\n\n    private onComponentAdded(e:ComponentEvent) {\n        this.addComponent(e.component);\n    }\n\n\n    private onComponentRemoved(e:ComponentEvent) {\n        var declarations = e.component.getOptionDeclarations();\n        for (var declaration of declarations) {\n            this.owner.removeDeclarationByName(declaration.name);\n        }\n    }\n}\n"]}